"use strict";(self.webpackChunkecommerce_cart=self.webpackChunkecommerce_cart||[]).push([[533],{533:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var a=r(43),o=r(579);const c=()=>{const[e,t]=(0,a.useState)([]),[r,c]=(0,a.useState)(!0),[s,i]=(0,a.useState)(null);(0,a.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("userEmail");if(!e)throw new Error("User email not found in localStorage");const r=await fetch(`https://ecart-wybs.onrender.com/cart/getItems?email=${e}`),a=await r.json();if(!Array.isArray(a))throw new Error("Fetched cart data is not an array");const o=a.map((e=>({...e,discountPercent:Math.floor(31*Math.random())+10})));t(o),c(!1)}catch(s){console.error("Error fetching cart items:",s),i(s.message),c(!1)}})()}),[]);const n=(e,t)=>e*t/100,l=()=>e.reduce(((e,t)=>e+t.price*t.quantity),0),d=()=>e.reduce(((e,t)=>e+n(t.price,t.discountPercent)*t.quantity),0);return r?(0,o.jsx)("p",{children:"Loading..."}):s?(0,o.jsxs)("p",{children:["Error: ",s]}):(0,o.jsx)("div",{className:"container mx-auto p-4",children:0===e.length?(0,o.jsx)("h2",{className:"text-xl font-semibold",children:"Cart is empty"}):(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{className:"text-xl font-semibold",children:"Your items are:"}),(0,o.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-4",children:e.map((e=>(0,o.jsxs)("div",{className:"border rounded-lg p-4 shadow-md",children:[(0,o.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-48 object-cover mb-2"}),(0,o.jsx)("h3",{className:"text-lg font-medium mb-2",children:e.title}),(0,o.jsxs)("p",{className:"text-gray-700",children:["Price: $",e.price.toFixed(2)]}),(0,o.jsxs)("p",{className:"text-green-600",children:["Discount: ",e.discountPercent,"% ($",n(e.price,e.discountPercent).toFixed(2),")"]}),(0,o.jsxs)("div",{className:"flex items-center mt-2",children:[(0,o.jsx)("button",{className:"bg-gray-200 text-gray-700 px-2 py-1 rounded hover:bg-gray-300",onClick:()=>(async e=>{try{const r=localStorage.getItem("userEmail");if(!(await fetch("https://ecart-wybs.onrender.com/cart/deleteItem",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,productTitle:e})})).ok)throw new Error("Failed to delete item");t((t=>t.map((t=>t.title===e?{...t,quantity:t.quantity-1}:t)).filter((e=>e.quantity>0))))}catch(s){console.error("Error removing item:",s)}})(e.title),children:"-"}),(0,o.jsx)("span",{className:"mx-2",children:e.quantity}),(0,o.jsx)("button",{className:"bg-gray-200 text-gray-700 px-2 py-1 rounded hover:bg-gray-300",onClick:()=>(async e=>{try{const r=localStorage.getItem("userEmail"),{productId:a,image:o,title:c,price:s}=e;if(!(await fetch("https://ecart-wybs.onrender.com/cart/addItem",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,productId:a,image:o,title:c,price:s,quantity:1})})).ok)throw new Error("Failed to add item");t((e=>e.map((e=>e.productId===a?{...e,quantity:e.quantity+1}:e))))}catch(s){console.error("Error adding item:",s)}})(e),children:"+"})]}),(0,o.jsx)("button",{className:"bg-red-500 text-white px-4 py-2 mt-2 rounded hover:bg-red-700",onClick:()=>(async e=>{try{const r=localStorage.getItem("userEmail");if(!(await fetch("https://ecart-wybs.onrender.com/cart/deleteItems",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,productTitle:e})})).ok)throw new Error("Failed to delete item");t((t=>t.filter((t=>t.title!==e))))}catch(s){console.error("Error removing item:",s)}})(e.title),children:"Remove All"})]},e.productId)))}),(0,o.jsxs)("div",{className:"mt-8 border-t pt-4",children:[(0,o.jsx)("h3",{className:"text-xl font-semibold",children:"Cart Summary"}),(0,o.jsxs)("p",{className:"text-gray-700 mt-2",children:["Subtotal: $",l().toFixed(2)]}),(0,o.jsxs)("p",{className:"text-gray-700 mt-2",children:["Total Discount: $",d().toFixed(2)]}),(0,o.jsxs)("p",{className:"text-gray-700 mt-2 font-semibold",children:["Total: $",(l()-d()).toFixed(2)]}),(0,o.jsx)("button",{className:"bg-blue-500 text-white px-4 py-2 mt-4 rounded hover:bg-blue-700",onClick:()=>alert("Proceeding to checkout..."),children:"Checkout"}),(0,o.jsx)("button",{className:"bg-red-600 text-white px-4 py-2 mt-4 ml-4 rounded hover:bg-red-800",onClick:async()=>{try{const e=localStorage.getItem("userEmail");if(!(await fetch("https://ecart-wybs.onrender.com/cart/emptyCart",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})})).ok)throw new Error("Failed to clear the cart");t([])}catch(s){console.error("Error clearing cart:",s)}},children:"Clear Cart"})]})]})})}}}]);
//# sourceMappingURL=533.a2aad774.chunk.js.map